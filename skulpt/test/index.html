<html>
  <head>
    <script
      src="https://cdn.jsdelivr.net/gh/skulpt/skulpt-dist/skulpt.min.js"
      type="text/javascript"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/gh/skulpt/skulpt-dist/skulpt-stdlib.js"
      type="text/javascript"
    ></script>
  </head>

  <body>
    <h3>Try This</h3>
    <form>
      <textarea id="yourcode" cols="80" rows="10">
import turtle
print('hello')
t = turtle.Turtle()
t.color('red')
t.forward(75)
  </textarea
      ><br />
      <button type="button" onclick="runit()">Run</button>
    </form>
    <pre id="output"></pre>
    <div id="mycanvas"></div>
    <script>


      // 第三方模块列表
      var externalLibs = {
        // 确保模块路径能访问到，这里我用的是相对路径./mod.js
        "./mod/__init__.js": "./mod.js", 
      };


      function outf(text) {
        var mypre = document.getElementById("output");
        mypre.innerHTML = mypre.innerHTML + text;
      }
      function builtinRead(file) {
        console.log("Attempting file: " + Sk.ffi.remapToJs(file));
        if (
          Sk.builtinFiles === undefined ||
          Sk.builtinFiles.files[file] === undefined
        ) {
          throw "File not found: '" + file + "'";
        }
        return Sk.builtinFiles.files[file];
      }
      function runit() {
        var prog = document.getElementById("yourcode").value;
        var mypre = document.getElementById("output");
        mypre.innerHTML = "";
        Sk.pre = "output";
        Sk.configure({
          output: outf, // 输出
          read: builtinRead, // 导入模块
          __future__: Sk.python3,
        });

        (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = "mycanvas"; // 设置海龟绘图元素
        var myPromise = Sk.misceval.asyncToPromise(function() {
          return Sk.importMainWithBody("<stdin>", false, prog, true);
        });

        myPromise.then(
          function(mod) {
            console.log("success");
          },
          function(err) {
            console.log(err.toString());
          }
        );
      }
    </script>
  </body>
</html>

